# Vercel 部署指南

本文件將指導您如何將 FlipReact Plus 電子書平台部署到 Vercel,實現全球 CDN 加速和自動化部署流程。

## 部署前準備

在開始部署之前,請確認您已經完成 Supabase 後端的設置,並且本地開發環境運作正常。確保所有必要的環境變數都已正確配置,並且應用程式在本地可以正常執行。

## 部署方式

### 方法一:透過 GitHub 自動部署(推薦)

這是最推薦的部署方式,可以實現代碼推送後的自動部署更新。首先,將您的專案推送到 GitHub repository。前往 Vercel 官網並使用 GitHub 帳號登入。在 Vercel 儀表板中,點擊「New Project」按鈕,選擇您的 GitHub repository 進行匯入。

Vercel 會自動偵測到這是一個 Vite 專案,並套用適當的建置設定。在配置頁面中,您需要設置環境變數。點擊「Environment Variables」展開環境變數設定區域,添加以下變數:

```
VITE_SUPABASE_URL: 您的 Supabase 專案 URL
VITE_SUPABASE_ANON_KEY: 您的 Supabase anon 金鑰
```

確認所有設定正確後,點擊「Deploy」開始部署。Vercel 會自動執行建置流程,通常只需要幾分鐘時間。部署完成後,您會獲得一個專屬的 Vercel 域名,可以立即訪問您的應用程式。

### 方法二:使用 Vercel CLI

如果您偏好命令行操作,可以使用 Vercel CLI 進行部署。首先,安裝 Vercel CLI:

```bash
npm install -g vercel
```

在專案根目錄中執行登入命令:

```bash
vercel login
```

接著執行部署命令。首次部署時,CLI 會詢問一些專案配置問題,按照提示回答即可:

```bash
vercel
```

對於生產環境部署,使用以下命令:

```bash
vercel --prod
```

部署過程中,系統會提示您設置環境變數。請輸入 Supabase 相關的環境變數資訊。

## 自動部署設置

透過 GitHub 整合,您可以實現自動化部署流程。Vercel 會自動監聽您的 GitHub repository,當有新的提交推送到主分支時,會自動觸發建置和部署流程。

您還可以為其他分支設置預覽部署。這讓您能在正式發佈前,先在獨立的預覽環境中測試新功能。每個 Pull Request 都會自動生成一個預覽部署,方便進行代碼審查和功能驗證。

## 自訂域名設置

Vercel 允許您使用自己的域名。在專案設定中前往「Domains」頁面,點擊「Add」添加您的域名。Vercel 會提供 DNS 記錄配置指示,按照說明在您的域名提供商處添加相應的記錄即可。

DNS 記錄生效後,Vercel 會自動為您的域名配置 SSL 證書,確保所有通訊都透過 HTTPS 加密進行。

## 環境變數管理

Vercel 支援為不同環境設置不同的環境變數。您可以為 Production、Preview 和 Development 環境分別配置變數。這讓您能在不同環境中使用不同的 Supabase 專案或其他服務配置。

在專案設定的「Environment Variables」頁面,您可以編輯、添加或刪除環境變數。變數更新後,需要重新部署才會生效。

## 效能優化

Vercel 自動提供全球 CDN 加速,確保用戶無論身在何處都能快速存取您的應用程式。建置過程會自動進行代碼分割和壓縮,優化載入效能。

您可以在 Vercel 儀表板的 Analytics 頁面查看詳細的效能數據,包括頁面載入時間、Core Web Vitals 等指標。這些數據幫助您了解應用程式的實際表現,並找出可以改進的地方。

## 監控與除錯

Vercel 提供完整的部署日誌和即時監控功能。如果部署失敗,您可以在 Deployment 頁面查看詳細的錯誤訊息和建置日誌。

Function Logs 頁面顯示 Serverless Functions 的執行記錄,幫助您除錯後端邏輯。Real-time 頁面提供即時的訪問統計和錯誤追蹤。

## 疑難排解

如果遇到建置失敗,首先檢查環境變數是否正確設置。確認所有必要的變數都已添加,且名稱和值都正確無誤。

如果應用程式部署成功但無法正常運作,檢查瀏覽器的開發者工具控制台,查看是否有 JavaScript 錯誤或網路請求失敗。確認 Supabase 服務是否正常運作,RLS 政策是否正確配置。

如果自訂域名無法存取,檢查 DNS 記錄是否已正確配置且已生效。DNS 記錄的更新可能需要一些時間,通常在 24 小時內會完全生效。

## 更新與維護

部署後,您可以繼續在本地開發新功能。當準備發佈更新時,只需將代碼推送到 GitHub,Vercel 會自動開始建置和部署流程。

建議為重要的更新建立 Pull Request,利用預覽部署功能進行測試。確認一切正常後再合併到主分支,這樣可以避免將有問題的代碼部署到生產環境。

定期檢查 Vercel 儀表板的效能數據和錯誤報告,及時發現和解決問題。監控應用程式的使用量,確保不會超出 Vercel 方案的限制。

## 成本考量

Vercel 提供慷慨的免費方案,對於個人專案和小型應用來說通常已經足夠。免費方案包括無限的部署、100GB 頻寬和自動 SSL 證書。

如果需要更高的效能和更多功能,可以考慮升級到付費方案。Pro 方案提供更多的建置時間、優先支援和進階分析功能。Enterprise 方案則適合大型組織,提供自訂 SLA 和專屬支援團隊。

完成這些步驟後,您的 FlipReact Plus 電子書平台就已經成功部署到 Vercel,可以開始為用戶提供服務了。
